---
title: "Example Plugins"
description: "Reference plugin implementations in the repository"
---

The repository includes example plugins demonstrating common patterns. These show the integration approach used in the actual clark agent.

**Reference:** Feed implementations in `backend/convex/tick.ts`

## Feed Plugins

### 4chan Feed

Fetches trending threads from SFW 4chan boards. Demonstrates routine-based source rotation and activity scoring.

| Config | Description |
|--------|-------------|
| `CHAN_BOARDS` | SFW boards: g, sci, lit, mu, his, fit, ck, fa, tg, biz, tv, vg |
| `CHAN_BOARD_ROTATION` | Maps routine → active boards |
| `CHAN_REFRESH_MS` | Cooldown between fetches |

**How it works:**

1. **Board selection** — Picks board based on routine (morning gets tech/science, evening gets literature/music)
2. **Fetch catalog** — Calls `api.4chan.org/{board}/catalog.json`
3. **Score threads** — Ranks by `replies + images` for activity
4. **Sanitize text** — Strips HTML, decodes entities, filters blocked content
5. **Store as knowledge** — Saves with type "chan" and board source

**Reference:** `pickChanThread()`, `maybeInjectChan()` in `backend/convex/tick.ts`

### News Feed

Aggregates news from HN, BBC, and RSS sources. Uses routine-based source rotation.

| Config | Description |
|--------|-------------|
| `RSS_SOURCES` | Feed URLs by source name |
| `NEWS_SOURCE_ROTATION` | Maps routine → preferred sources |
| `NEWS_REFRESH_MS` | Cooldown between fetches |
| `NEWS_MIN_SCORE` | Minimum HN score threshold |

**How it works:**

1. **Source rotation** — Morning prefers HN/tech, evening prefers general news
2. **Fetch stories** — From RSS feeds or HN API
3. **Filter duplicates** — Compares against existing knowledge titles
4. **Store as knowledge** — Saves with type "news" and source attribution

**Reference:** `pickNewsStory()`, `maybeInjectNews()` in `backend/convex/tick.ts`

### Markets Feed

Fetches cryptocurrency price data and trending tokens.

| Config | Description |
|--------|-------------|
| `MARKET_REFRESH_MS` | Price refresh interval |
| Symbols | Configurable token list |

**Reference:** `maybeInjectMarket()` in `backend/convex/tick.ts`

## Knowledge Types

Feeds store data as knowledge items with these types:

| Type | Source | Description |
|------|--------|-------------|
| `chan` | 4chan boards | Thread subjects and content |
| `news` | HN, BBC, RSS | Headlines and URLs |
| `market` | DexScreener, CoinGecko | Price data and trends |
| `prediction` | Polymarket | Prediction market data |

**Reference:** `normalizeType()` in `backend/convex/knowledge.ts`

## Plugin Pattern

The ink SDK uses a service-based pattern for feeds:

```typescript
export class NewsService implements Service {
  name = 'news';
  type: ServiceType = 'news';

  private cache: NewsItem[] = [];
  private lastRefresh: number | null = null;

  async refresh(): Promise<void> {
    // Fetch from sources
    // Deduplicate by similarity
    // Update cache
  }

  async getData<T = NewsItem[]>(): Promise<T> {
    return this.cache as T;
  }
}
```

**Reference:** `src/services/news.ts` in ink

## Implementing Custom Feeds

To add a new feed source:

1. **Define source config** — URLs, rotation schedule, refresh interval
2. **Implement fetcher** — Call external API, parse response
3. **Score/filter content** — Activity metrics, blocked phrases
4. **Store as knowledge** — Use appropriate type, include source attribution

```typescript
// Example: Custom feed injection
const maybeInjectCustomFeed = async (ctx, knowledge, nowMs, routine) => {
  const lastAt = latestTimestamp(knowledge, isCustomItem);
  if (lastAt && nowMs - lastAt < REFRESH_MS) return knowledge;

  const item = await fetchCustomSource(routine);
  if (!item) return knowledge;

  const entry = await ctx.runMutation(api.knowledge.addKnowledge, {
    text: item.text,
    url: item.url,
    type: "custom",
    author: item.source
  });

  return [entry, ...knowledge];
};
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Build Your Own" href="/guides/custom-plugins">
    Create custom plugins for your use case.
  </Card>
  <Card title="Plugin SDK" href="/api-reference/sdk/plugins">
    Full plugin interface reference.
  </Card>
</CardGroup>
